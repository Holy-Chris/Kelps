### SENTINELSAT-tuile v.1.0
### Téléchargement à l'aide du nom de tuile ==> NE FONCTIONNE QUE POUR IMAGES EN L1C

import sentinelsat
from sentinelsat import SentinelAPI, read_geojson, geojson_to_wkt
from datetime import date
from collections import OrderedDict

download_path="F:\\Images Sat Kerguelen\\2019\\Sentinel-2 L1C"

api= SentinelAPI('christophercrovetto', 'ds.N3vwaGMiabPL', 'https://apihub.copernicus.eu/apihub')


# tuiles à rechercher

tiles = ['42FVM','42FWM','42FVL','42FWL','42FXL','42FVK','42FWK']

query_kwargs = {
        'platformname': 'Sentinel-2',
        'producttype': 'S2MSI1C',
        'date': ('20190101','20191231'),
        'cloudcoverpercentage':(0,5)}


products = OrderedDict()
for tile in tiles:
    kw = query_kwargs.copy()
    kw['tileid'] = tile
    pp = api.query(**kw)
    products.update(pp)
    
    
    
# nombre de résultats de recherche
print(len(products))

# Téléchargement des images
api.download_all(products,directory_path=download_path)

